\section{The type of flow systems considered}
\label{sec:typeofflow}

We consider flow in two-dimensional dynamical systems of the form
\begin{equation}
    \label{eq:odeflowsystem}
\dot{\vct{x}} = \vct{v}(t,\vct{x}),\quad\vct{x}\in\mathcal{U},\quad{}t\in[t_{0},t_{1}],
\end{equation}
i.e., systems defined for the finite time interval $[t_{0},t_{1}]$, on an open,
bounded subset $\mathcal{U}$ of $\mathbb{R}^{2}$. In addition, the velocity
field $\vct{v}$ is assumed to be smooth in its arguments. Depending on the
exact nature of the velocity field $\vct{v}$, analytical particle trajectories,
that is, analytical solutions of system~\eqref{eq:odeflowsystem}, may or may
not be computed. The flow particles are assumed to be infinitesimal and
massless, i.e., non-interacting \emph{tracers} of the overall circulation.

Letting $\vct{x}(t;t_{0},\vct{x}_{0})$ denote the trajectory of a tracer in the
system defined by~\eqref{eq:odeflowsystem}, the flow map is defined as
\begin{equation}
    \label{eq:flowmap}
    \vct{F}_{t_{0}}^{t}(\vct{x}_{0}) = \vct{x}(t;t_{0},\vct{x}_{0}),
\end{equation}
i.e., the flow map describes the mathematical movement of the tracers from
one point in time to another. Generally, the flow map is as smooth as the
velocity field $\vct{v}$ in system \eqref{eq:odeflowsystem}
\parencite{farazmand2012computing}. For sufficiently
smooth velocity fields, the right Cauchy-Green strain tensor field is defined as
\begin{equation}
    \label{eq:cauchygreen}
    \mtrx{C}_{t_{0}}^{t}(\vct{x}_{0}) = %
    {\big(\vct{\nabla}\vct{F}_{t_{0}}^{t}(\vct{x}_{0})\big)}^{\ast} %
    \,\vct{\nabla}\vct{F}_{t_{0}}^{t}(\vct{x}_{0}),
\end{equation}
where $\vct{\nabla}\vct{F}_{t_{0}}^{t}$ denotes the Jacobian matrix of the flow
map $\vct{F}_{t_{0}}^{t}$, and the asterisk refers to the adjoint operation,
which, because the Jacobian $\vct{\nabla}\vct{F}_{t_{0}}^{t}$ is real-valued,
equates to matrix transposition. Component-wise, the Jacobian matrix of a
general vector-valued function $\vct{f}$ is defined as
\begin{equation}
    \label{eq:jacobiancomponent}
    {(\vct{\nabla}\vct{f})}_{i,j} = \pdv{f_{i}}{x_{j}},\quad%
\vct{f}=\vct{f}(\vct{x})=\begin{pmatrix}f_{1}(\vct{x}),f_{2}(\vct{x}),\ldots\end{pmatrix},
\end{equation}
which, for our two-dimensional flow, reduces to
\begin{equation}
    \label{eq:jacobiantotal}
    \renewcommand{\arraystretch}{2.5}
    \vct{\nabla}\vct{f} = \begin{pmatrix} %
        \dfrac{\partial{}f_{1}}{\partial{}x} %
                                    & \dfrac{\partial{}f_{1}}{\partial{}y}\\
        \dfrac{\partial{}f_{2}}{\partial{}x} %
                                    & \dfrac{\partial{}f_{2}}{\partial{}y}%
                        \end{pmatrix}.
\end{equation}

By construction, the Cauchy-Green strain tensor $\mtrx{C}_{t_{0}}^{t}$ is
symmetric and positive definite. Thus, it has two real, positive eigenvalues
and orthogonal, real eigenvectors. Its eigenvalues $\lambda_{i}$ and
corresponding unit eigenvectors $\vct{\xi}_{i}$ are defined by
\begin{equation}
    \label{eq:cauchygreencharacteristics}
    \begin{gathered}
        \mtrx{C}_{t_{0}}^{t}(\vct{x}_{0})\vct{\xi}_{i}(\vct{x}_{0}) %
            = \lambda_{i}\vct{\xi}_{i}(\vct{x}_{0}),%
            \quad\norm{\vct{\xi}_{i}(\vct{x}_{0})}=1,\quad{}i=1,2,\\
        0<\lambda_{1}(\vct{x}_{0})\leq\lambda_{2}(\vct{x}_{0}),
    \end{gathered}
\end{equation}
where, for the sake of notational transparency, the dependence of $\lambda_{i}$
and $\vct{\xi}_{i}$ on $t_{0}$ and $t$ has been suppressed. The geometric
interpretation of equation~\eqref{eq:cauchygreencharacteristics} is that
a fluid element undergoes the most stretching along the $\vct{\xi}_{2}$ axis,
and the least along the $\vct{\xi}_{1}$ axis. This concept is shown in figure
\ref{fig:stretch_and_strain}.

\input{mainmatter/theory/figures/stretch_and_strain.tex}

Because the stretch factors along the $\vct{\xi}_{1}$ and $\vct{\xi}_{2}$ axes
are given by the square root of the corresponding eigenvalues, for
incompressible flow, the eigenvalues satisfy
\begin{equation}
    \label{eq:cauchygreenincomprlambda}
    \lambda_{1}(\vct{x}_{0})\lambda_{2}(\vct{x}_{0})=1%
        \quad\forall\hskip0.5em\vct{x}_{0}\in\mathcal{U}
\end{equation}
where, for our case, incompressibility is equivalent to the velocity field
$\vct{v}$ being divergence-free (i.e., $\vct{\nabla}\vdot\vct{v}\equiv0$).
%This is due to the tracer particles being massless, per definiton.

\section[Definition of Lagrangian Coherent Structures for two-dimensional flows ]
{Definition of Lagrangian coherent structures for\\\phantom{2.3 }two-dimensional flows}
\label{sec:definition_of_lcss_for_two-dimensional_flow}
Lagrangian coherent structures (henceforth abbreviated to LCSs) can be described
as time-evolving surfaces which shape coherent trajectory patterns in dynamical
systems, defined over a finite time interval \parencite{haller2010variational}.
There are three main types of LCSs, namely \emph{elliptic},
\emph{hyperbolic} and \emph{parabolic}. Roughly speaking, parabolic structures
outline cores of jet-like trajectories, elliptic structures describe vortex
boundaries, whereas hyperbolic structures illustrate overall attractive or
repelling manifolds. As such, hyperbolic LCSs practically act as organizing
centers of observable tracer patterns \parencite{onu2015lcstool}. Because
hyperbolic LCSs provide the most readily applicable insight in terms of
forecasting flow in e.g.\ oceanic currents, such structures have been the focus
of this project.

\clearpage

\subsection{Hyperbolic LCSs}
\label{sub:hyperbolic_lcss}

The identifacion of LCSs for reliable forecasting requires sufficiency and necessity
conditions, supported by mathematical theorems. \textcite{haller2010variational}
derived a variational LCS theory based on the Cauchy-Green strain tensor,
defined by equation~\eqref{eq:cauchygreen}, from which the aforementioned
conditions follow. The immediately relevant parts of Haller's theory
are quoted in
\cref{def:normalrepellence,def:repellinglcs,def:attractinglcs,def:hyperboliclcs}
\parencite{haller2010variational}.\\

\begin{defn}
    \label{def:normalrepellence}
    A \emph{normally repelling material line} over the time interval
    $[t_{0},t_{0}+T]$ is a compact material line segment $\mathcal{M}(t)$
    which is overall repelling, and on which the normal repulsion rate
    is greater than the tangential repulsion rate.
\end{defn}

A \emph{material line} is a smooth curve $\mathcal{M}(t_{0})$ at time $t_{0}$,
which is advected by the flow map, given by equation~\eqref{eq:flowmap}, into
the dynamic material line
$\mathcal{M}(t)=\vct{F}_{t_{0}}^{t}\mathcal{M}(t_{0})$. The required
\emph{compactness} of the material line segment signifies that, in some sense,
it must be topologically well-behaved. That the material line is
\emph{overall repelling} means that nearby trajectories are repelled from,
rather than attracted to, the material line. Lastly, requiring that the
\emph{normal repulsion rate} is greater than the
\emph{tangential repulsion rate} means that nearby trajectories are in fact
driven away from the material line, rather than being stretched
\emph{along with} it due to shear stress.
\\
\begin{defn}
    \label{def:repellinglcs}
    A \emph{repelling LCS} over the time interval $[t_{0},t_{0}+T]$ is a
    normally repelling material line $\mathcal{M}(t_{0})$ whose normal repulsion
    admits a pointwise non-degenerate maximum relative to any nearby material
    line $\widehat{\mathcal{M}}(t_{0})$.\\
\end{defn}
\begin{defn}
    \label{def:attractinglcs}
    An \emph{attracting LCS}  over the time interval $[t_{0},t_{0}+T]$ is
    defined as a repelling LCS over the \emph{backward} time interval
    $[t_{0}+T,t_{0}]$.\\
\end{defn}
\begin{defn}
    \label{def:hyperboliclcs}
    A \emph{hyperbolic} LCS over the time interval $[t_{0},t_{0}+T]$ is a
    \emph{repelling} or \emph{attracting} LCS over the same time interval.
\end{defn}

Note that the above definitions associate LCSs with the time interval $I$ over
which the dynamical system under consideration is known, or, at the very least,
where information regarding the behaviour of tracers, is sought. Generally,
LCSs obtained over a time interval $I$ do not exist over different time
intervals \parencite{farazmand2012computing}.

For two-dimensional flow, the above definitions can be summarized as a set of
mathematical existence criteria, based on the Cauchy-Green strain tensor,
\parencite{haller2010variational,farazmand2011erratum}. These are given in
\cref{thm:lcsexistence}:

\clearpage

\begin{thm}[Sufficient and necessary conditions for LCSs in two-dimensional
    flows]
    \label{thm:lcsexistence}
    Consider a compact material line $\mathcal{M}(t)\subset\mathcal{U}$ evolving
    over the time interval $[t_{0},t_{0}+T]$. $\mathcal{M}(t)$ is a repelling
    LCS over $[t_{0},t_{0}+T]$ if and only if all the following hold for all
    initial conditions $\vct{x}_{0}\in\mathcal{M}(t_{0})$:
    \begin{subequations}
        \label{eq:lcsexistence}
        \begin{align}
            \label{eq:lcsexistence1}
            &\lambda_{1}(\vct{x}_{0})\neq\lambda_{2}(\vct{x}_{0})>1\\
            \label{eq:lcsexistence2}
            &\big\langle\vct{\xi}_{2}(\vct{x}_{0}),%
            \mtrx{H}_{\lambda_{2}}(\vct{x}_{0})\vct{\xi}_{2}(\vct{x}_{0})\big\rangle<0\\
            \label{eq:lcsexistence3}
            &\vct{\xi}_{2}(\vct{x}_{0})\perp\mathcal{M}(t_{0})\\
            \label{eq:lcsexistence4}
            &\big\langle\vct{\nabla}\lambda_{2}(\vct{x}_{0}),%
                \vct{\xi}_{2}(\vct{x}_{0})\big\rangle=0
        \end{align}
    \end{subequations}
\end{thm}
In \cref{thm:lcsexistence}, $\langle\cdot,\cdot\rangle$ denotes the Euclidean
inner product, and $\mtrx{H}_{\lambda_{2}}$ denotes the Hessian matrix of the
set of largest eigenvalues of the Cauchy-Green strain tensor. Component-wise,
the Hessian matrix of a general, smooth, scalar-valued function $f$ is defined
as
\begin{equation}
    \label{eq:hessiancomponent}
    {(\mtrx{H}_{f})}_{i,j} = \pdv[2]{f}{x_{i}}{x_{j}},
\end{equation}
which, for our two-dimensional flow, reduces to
\begin{equation}
    \label{eq:hessiantotal}
    \renewcommand{\arraystretch}{2.5}
    \mtrx{H}_{f} = \begin{pmatrix}%
    \dfrac{\partial{}^{2}f}{\partial{x}^{2}} & %
                \dfrac{\partial{}^{2}f}{\partial{x}\partial{y}} \\
                \dfrac{\partial{}^{2}f}{\partial{y}\partial{x}} & %
                \dfrac{\partial{}^{2}f}{\partial{y}^{2}} \\
            \end{pmatrix}
\end{equation}
Condition~\eqref{eq:lcsexistence1} ensures that the normal repulsion rate is
larger than the tangential stretch due to shear strain along the LCS, as per
\cref{def:normalrepellence}. Conditions~\eqref{eq:lcsexistence3} and
\eqref{eq:lcsexistence4} suffice to ensure that the normal repulsion rate
attains a local extremum along the LCS, relative to all nearby material lines.
Lastly, condition~\eqref{eq:lcsexistence2} forces this to be a strict
local apex.

\section{FTLE fields as predictors for LCSs}
\label{sec:ftle_fields_as_predictors_for_lcss}

Finite-time Lyapunov exponent (hereafter abbreviated to FTLE) fields provide
a measure of the extent to which particles which start out close to eachother,
are separated in a given time interval. Mathematically, Lyapunov exponents
quantify the asymptotic divergence or convergence of trajectories of
tracers which start out infinitesimally close to each other
\parencite[pp.328--330]{strogatz2014nonlinear}. The FTLE field
is intrinsically linked to the Cauchy-Green strain tensor. When a
two-dimensional system is evolved from time $t_{0}$ to $t_{0}+T$, the FTLE field
is defined as
\begin{equation}
    \label{eq:ftledef}
    \sigma(\vct{x}_{0}) = \frac{\ln\big(\lambda_{2}(\vct{x}_{0})\big)}{2\abs{T}},
\end{equation}
\clearpage
where $\lambda_{2}(\vct{x}_{0})$ is the largest eigenvalue of the Cauchy-Green
strain tensor. The absolute value of the integration time $T$ is taken because
one generally can consider the evolution of a system in either temporal
direction. Analogously to \cref{def:attractinglcs}, the attraction of nearby
trajectories can be estimated by FTLEs found by means of integration backwards
in time.

\textcite{shadden2005definition} in fact \emph{define} hyperbolic LCSs as ridges
of the FTLE field. By \emph{ridges}, they mean gradient lines which are
orthogonal to the direction of minimum curvature.
\textcite{haller2010variational} showed, by means of explicit examples, that the
sole use of the FTLE field for LCS detection is prone to both false positives
and false negatives, even for conceptually simple flows. Furthermore, the FTLE
field is generally less well-resolved than the LCSs obtained from Haller's
variational formalism. For these reasons, the FTLE field can generally be used
as a first approximation in terms of where one can reasonably expect LCSs
to be found, but it does not represent the blueprint for the actual LCSs of a
system in general.
